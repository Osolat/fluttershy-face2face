<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.anychart.com/releases/8.8.0/js/anychart-core.min.js"></script>
    <script src="https://cdn.anychart.com/releases/8.8.0/js/anychart-graph.min.js"></script>
    <script src="https://cdn.anychart.com/releases/8.8.0/js/anychart-data-adapter.min.js"></script>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Face-2-Face</title>
    <link
            href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <link rel="stylesheet" href="./stylesheets/style.css"/>
    <script src="./javascripts/room.js" type="module"></script>
    <script src="/timesync/timesync.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
</head>
<body>

<!--<div id="audioPopup" class="popup">
    &lt;!&ndash; Modal content &ndash;&gt;
    <div class="modal-content" id="audioPopUpModal">
        <button id="audio-popup-button"></button>
    </div>
</div>-->

<div class="container">
    <header class="header">
        <div class="logo-container">
            <img src="./images/chat-icon.png" alt="doge logo" class="logo-img"/>
            <h1 class="logo-text">
                Face-<span class="logo-highlight">2-Face</span>
            </h1>
        </div>
        <div class="room-header" id="room-header-id">
        </div>
        <button id="audio-test"> Secret Audio Test</button>
    </header>
    <div class="content-container">
        <div class="active-users-panel" id="active-user-container" style="overflow-y: scroll;">
            <h3 class="panel-title">Active Users:</h3>
        </div>
        <div class="focus-container">
            <div class="tabBar" id="tabBar">
                <button class="tablink" onclick="openPage('VideoTab', this, '#65A9E5')" id="defaultOpen">Video <span
                        onclick="this.parentElement.style.display='none'" class="topright">&times</span></button>
                <button class="tablink" onclick="openPage('Document', this, '#65A9E5')">Document <span
                        onclick="this.parentElement.style.display='none'" class="topright">&times</span></button>
                <button class="tablink" onclick="openPage('HomeworkTODO', this, '#65A9E5')">Homework/TODO <span
                        onclick="this.parentElement.style.display='none'" class="topright">&times</span></button>
                <button class="tablink" onclick="openPage('NetworkTab', this, '#65A9E5')">Network <span
                        onclick="this.parentElement.style.display='none'" class="topright">&times</span></button>
                <button class="tabCreate" id="new" onclick="createButton()">+</button>
            </div>

            <div class="video-container" id="focus-video">
                <!--
                                <video autoplay class="remote-video" id="remote-video"></video>
                -->


                <div id="VideoTab" class="tabcontent">
                </div>

                <div id="Document" class="tabcontent">
                    <embed src="pdfs/Cryptography.pdf" width="100%" height="100%"/>
                </div>

                <div id="HomeworkTODO" class="tabcontent" style="overflow: scroll;">

                    <h2>Homework/TODO</h2>
                    <h3>README:</h3>
                    <p , contenteditable="true">This is a repository for the P2P course, which aims to implement WebRTC
                        and some P2P architecture to create a collaborative video conference application</p>
                    <h3>TODO:</h3>
                    <ul , contenteditable="true">
                        <li> Need new main page.</li>
                        <li> Support multiple different callers at once.</li>
                        <li> Implement file sharing system.</li>
                        <li> Chat system.</li>
                        <li> Database for storing chatlogs.</li>
                        <li> Homework feature.</li>
                        <li> Meeting schedule.</li>
                        <li> Display different tabs with content for all users.</li>
                    </ul>
                    <h3>Interesting Links:</h3>
                    <ul>
                        <li><a href="https://users-cs.au.dk/bouvin/dBIoTP2PC/2020/projects/#panzoom">https://users-cs.au.dk/bouvin/dBIoTP2PC/2020/projects/#panzoom</a>
                        </li>
                        <li><a href="https://letsencrypt.org/">https://letsencrypt.org/ </a></li>
                        <li><a href="https://developers.google.com/web/tools/puppeteer/">https://developers.google.com/web/tools/puppeteer/</a>
                        </li>
                        <li><a href="https://alexei-led.github.io/post/pumba_docker_chaos_testing/">https://alexei-led.github.io/post/pumba_docker_chaos_testing/</a>
                        </li>
                        <li><a href="https://peertube.dk/ ">https://peertube.dk/ </a></li>
                        <li><a href="https://news.ycombinator.com/item?id=23398261">https://news.ycombinator.com/item?id=23398261 </a>
                        </li>
                        <li><a href="https://webtorrent.io/">https://webtorrent.io/ </a></li>
                        <li>
                            <a href="https://github.com/webrtc/samples/blob/gh-pages/src/content/peerconnection/multiple/js/main.js">https://github.com/webrtc/samples/blob/gh-pages/src/content/peerconnection/multiple/js/main.js </a>
                        </li>
                    </ul>
                </div>

                <div id="NetworkTab" class="tabcontent">
                    <h3>Network</h3>
                    <div id="container" class="plot"></div>
                    <script>
                        var data = {
                            nodes: [
                                {id: "me"}
                            ],
                            edges: [
                                {from: "me", to: "me"}
                            ]
                        };

                        // create a chart and set the data
                        var chart = anychart.graph(data);

                        chart.title("Network Graph showing all peers");
                        // draw the chart

                        // enable the labels of nodes
                        chart.nodes().labels().enabled(true);

                        // configure the labels of nodes
                        chart.nodes().labels().format("{%id}");
                        chart.nodes().labels().fontSize(12);
                        chart.nodes().labels().fontWeight(600);

                        // set the container id
                        chart.container("container");

                        // initiate drawing the chart
                        chart.draw();
                    </script>
                </div>
            </div>
            <div class="context-container">

                <script src="./javascripts/filetransferHtmlWrite.js"></script>

            </div>
        </div>
        <div class="text-chat-container">
            <h2>
                Chatlog
            </h2>
            <div class="chat-log">
                <ul id="chat-log-list">
                </ul>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chat-text-input">
            </div>
        </div>
        <video autoplay muted class="local-video" id="local-video"></video>
    </div>
</div>
<div>

</div>

<script>


    function openPage(pageName, elmnt, color) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = "";
        }
        document.getElementById(pageName).style.display = "block";
        elmnt.style.backgroundColor = color;
    }

    function closePage(elementId) {
        console.log("The id is :" + elementId)
        var element = document.getElementById(elementId);
        element.remove();
    }

    function createButton() {
        var myDiv = document.getElementById("tabBar");
        var existing = document.getElementById("new");

        var randLetter = String.fromCharCode(65 + Math.floor(Math.random() * 26));
        var uniqid = randLetter + Date.now()

        // creating button element
        var newTabBut = document.createElement('BUTTON');
        newTabBut.className = 'tablink'
        newTabBut.id = uniqid
        newTabBut.onclick = function () {
            openPage('HomeworkTODO', this, '#65A9E5')
        };

        newTabBut.innerHTML = "NewTab <span onclick='closePage(this.parentElement.id)' class='topright'> Ã— </span>"
        newTabBut.contentEditable = 'true'
        myDiv.insertBefore(newTabBut, existing);
    }

</script>
</body>
</html>